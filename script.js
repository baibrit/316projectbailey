var dataSet = [
  {
    County: "Johnson",
    "RatePer1,000": 747.33
  },
  {
    County: "Finney",
    "RatePer1,000": 740.95
  },
  {
    County: "McPherson",
    "RatePer1,000": 681.56
  },
  {
    County: "Shawnee",
    "RatePer1,000": 681.07
  },
  {
    County: "Douglas",
    "RatePer1,000": 678.2
  },
  {
    County: "Harvey",
    "RatePer1,000": 671.48
  },
  {
    County: "Kearny",
    "RatePer1,000": 670.44
  },
  {
    County: "Mitchell",
    "RatePer1,000": 652.9
  },
  {
    County: "Lyon",
    "RatePer1,000": 651.77
  },
  {
    County: "Seward",
    "RatePer1,000": 651.36
  },
  {
    County: "Wyandotte",
    "RatePer1,000": 644.38
  },
  {
    County: "Ford",
    "RatePer1,000": 642.41
  },
  {
    County: "Marshall",
    "RatePer1,000": 642.4
  },
  {
    County: "Sedgwick",
    "RatePer1,000": 635.36
  },
  {
    County: "Franklin",
    "RatePer1,000": 632.76
  },
  {
    County: "Washington",
    "RatePer1,000": 631.46
  },
  {
    County: "Jackson",
    "RatePer1,000": 624.94
  },
  {
    County: "Nemaha",
    "RatePer1,000": 618.94
  },
  {
    County: "Clay",
    "RatePer1,000": 615.86
  },
  {
    County: "Morris",
    "RatePer1,000": 614.02
  },
  {
    County: "Ellsworth",
    "RatePer1,000": 613.5
  },
  {
    County: "Jefferson",
    "RatePer1,000": 613.25
  },
  {
    County: "Atchison",
    "RatePer1,000": 612.87
  },
  {
    County: "Coffey",
    "RatePer1,000": 608.95
  },
  {
    County: "Labette",
    "RatePer1,000": 606.04
  },
  {
    County: "Stanton",
    "RatePer1,000": 604.38
  },
  {
    County: "Greeley",
    "RatePer1,000": 600
  },
  {
    County: "Ness",
    "RatePer1,000": 598.57
  },
  {
    County: "Wichita",
    "RatePer1,000": 596.53
  },
  {
    County: "Kiowa",
    "RatePer1,000": 590.45
  },
  {
    County: "Osborne",
    "RatePer1,000": 589.82
  },
  {
    County: "Crawford",
    "RatePer1,000": 588.47
  },
  {
    County: "Greenwood",
    "RatePer1,000": 588.17
  },
  {
    County: "Riley",
    "RatePer1,000": 586.72
  },
  {
    County: "Reno",
    "RatePer1,000": 585.65
  },
  {
    County: "Norton",
    "RatePer1,000": 585.18
  },
  {
    County: "Osage",
    "RatePer1,000": 585.07
  },
  {
    County: "Saline",
    "RatePer1,000": 584.87
  },
  {
    County: "Cloud",
    "RatePer1,000": 582.94
  },
  {
    County: "Butler",
    "RatePer1,000": 582.86
  },
  {
    County: "Gove",
    "RatePer1,000": 580.4
  },
  {
    County: "Republic",
    "RatePer1,000": 576.84
  },
  {
    County: "Pawnee",
    "RatePer1,000": 575.37
  },
  {
    County: "Meade",
    "RatePer1,000": 574.75
  },
  {
    County: "Grant",
    "RatePer1,000": 573.24
  },
  {
    County: "Dickinson",
    "RatePer1,000": 571.97
  },
  {
    County: "Smith",
    "RatePer1,000": 570.51
  },
  {
    County: "Ellis",
    "RatePer1,000": 568.91
  },
  {
    County: "Rush",
    "RatePer1,000": 568.29
  },
  {
    County: "Marion",
    "RatePer1,000": 560.27
  },
  {
    County: "Neosho",
    "RatePer1,000": 556.8
  },
  {
    County: "Pratt",
    "RatePer1,000": 554.25
  },
  {
    County: "Gray",
    "RatePer1,000": 553.55
  },
  {
    County: "Wabaunsee",
    "RatePer1,000": 553.28
  },
  {
    County: "Comanche",
    "RatePer1,000": 552.35
  },
  {
    County: "Clark",
    "RatePer1,000": 550.27
  },
  {
    County: "Harper",
    "RatePer1,000": 548.88
  },
  {
    County: "Trego",
    "RatePer1,000": 548.79
  },
  {
    County: "Cowley",
    "RatePer1,000": 548.59
  },
  {
    County: "Kingman",
    "RatePer1,000": 547.58
  },
  {
    County: "Scott",
    "RatePer1,000": 544.84
  },
  {
    County: "Rooks",
    "RatePer1,000": 544.18
  },
  {
    County: "Barton",
    "RatePer1,000": 543.09
  },
  {
    County: "Edwards",
    "RatePer1,000": 541.56
  },
  {
    County: "Montgomery",
    "RatePer1,000": 534
  },
  {
    County: "Allen",
    "RatePer1,000": 532.27
  },
  {
    County: "Logan",
    "RatePer1,000": 529.16
  },
  {
    County: "Anderson",
    "RatePer1,000": 528.66
  },
  {
    County: "Leavenworth",
    "RatePer1,000": 528.54
  },
  {
    County: "Barber",
    "RatePer1,000": 527.79
  },
  {
    County: "Stafford",
    "RatePer1,000": 527.47
  },
  {
    County: "Russell",
    "RatePer1,000": 526.36
  },
  {
    County: "Miami",
    "RatePer1,000": 520.31
  },
  {
    County: "Hodgeman",
    "RatePer1,000": 519.66
  },
  {
    County: "Graham",
    "RatePer1,000": 517.63
  },
  {
    County: "Woodson",
    "RatePer1,000": 516.81
  },
  {
    County: "Rice",
    "RatePer1,000": 514.71
  },
  {
    County: "Wilson",
    "RatePer1,000": 507.65
  },
  {
    County: "Sumner",
    "RatePer1,000": 505.45
  },
  {
    County: "Lincoln",
    "RatePer1,000": 503.12
  },
  {
    County: "Pottawatomie",
    "RatePer1,000": 498.02
  },
  {
    County: "Sherman",
    "RatePer1,000": 496.14
  },
  {
    County: "Lane",
    "RatePer1,000": 493.08
  },
  {
    County: "Phillips",
    "RatePer1,000": 490.85
  },
  {
    County: "Chase",
    "RatePer1,000": 487.44
  },
  {
    County: "Thomas",
    "RatePer1,000": 485.91
  },
  {
    County: "Geary",
    "RatePer1,000": 481.79
  },
  {
    County: "Cheyenne",
    "RatePer1,000": 481.69
  },
  {
    County: "Rawlins",
    "RatePer1,000": 473.9
  },
  {
    County: "Haskell",
    "RatePer1,000": 471.92
  },
  {
    County: "Hamilton",
    "RatePer1,000": 469.61
  },
  {
    County: "Linn",
    "RatePer1,000": 467.46
  },
  {
    County: "Ottawa",
    "RatePer1,000": 460.76
  },
  {
    County: "Bourbon",
    "RatePer1,000": 452.54
  },
  {
    County: "Jewell",
    "RatePer1,000": 452.46
  },
  {
    County: "Brown",
    "RatePer1,000": 451.02
  },
  {
    County: "Stevens",
    "RatePer1,000": 450.39
  },
  {
    County: "Decatur",
    "RatePer1,000": 447.36
  },
  {
    County: "Morton",
    "RatePer1,000": 434.96
  },
  {
    County: "Wallace",
    "RatePer1,000": 430.83
  },
  {
    County: "Chautauqua",
    "RatePer1,000": 429.68
  },
  {
    County: "Elk",
    "RatePer1,000": 414.58
  },
  {
    County: "Sheridan",
    "RatePer1,000": 413.42
  },
  {
    County: "Cherokee",
    "RatePer1,000": 404.1
  },
  {
    County: "Doniphan",
    "RatePer1,000": 362.23
  }
];

$(document).ready(function() {
  $("#example").DataTable({
    data: dataSet,
    processing: true,
    columns: [{ data: "County" }, { data: "RatePer1,000" }],
    language: {
      searchPlaceholder: "Search Data",
      search: ""
    },
    scrollX: 100,
    scrollY: 300,
    autoFill: true,
    paging: false,
    autoWidth: true
  });
});

Highcharts.getJSON("/vaccine.json", function(data) {
  /**
   * Data parsed from http://www.bls.gov/lau/#tables
   *
   * 1. Go to http://www.bls.gov/lau/laucntycur14.txt (or similar, updated
   *    datasets)
   * 2. In the Chrome Developer tools console, run this code:
   *    copy(JSON.stringify(document.body.innerHTML.split('\n').filter(function (s) { return s.indexOf('<PUT DATE HERE IN FORMAT e.g. Feb-14>') !== -1; }).map(function (row) { row = row.split('|'); return { code: 'us-' + row[3].trim().slice(-2).toLowerCase() + '-' + row[2].trim(), name: row[3].trim(), value: parseFloat(row[8]) }; })))
   * 3. The data is now on your clipboard, paste it below
   * 4. Verify that the length of the data is reasonable, about 3300
   *    counties.
   */

  var countiesMap = Highcharts.geojson(
      Highcharts.maps["countries/us/us-ks-all"]
    ),
    // Extract the line paths from the GeoJSON
    lines = Highcharts.geojson(
      Highcharts.maps["countries/us/us-ks-all"],
      "mapline"
    ),
    // Filter out the state borders and separator lines, we want these
    // in separate series
    borderLines = lines.filter(
      l => l.properties["hc-group"] === "__border_lines__"
    ),
    separatorLines = lines.filter(
      l => l.properties["hc-group"] === "__separator_lines__"
    );

  // Add state acronym for tooltip
  countiesMap.forEach(function(mapPoint) {
    mapPoint.name =
      mapPoint.name + " County " 
  });

  document.getElementById("container").innerHTML = "Rendering map...";

  // Create the map
  setTimeout(function() {
    // Otherwise innerHTML doesn't update
    Highcharts.mapChart("container", {
      chart: {
        borderWidth: 1,
        marginRight: 20 // for the legend
      },

      title: {
                    text: 'Kansas Vaccination Rate per 1,000 Residents,'
                },
                subtitle: {
                   text: 'November 11, 2021 <br> Source: KDHE',
                  y:30
                },

                        legend: {
            layout: 'horizontal',
            borderWidth: 0,
            backgroundColor: 'rgba(255,255,255,0.85)',
            floating: true,
            verticalAlign: 'top',
            y: 50
        },

      mapNavigation: {
        enabled: true
      },

      colorAxis: {
                    min: 0,
                    max: 1000,
                    tickInterval: 200,
                    stops: [[0, '#FFF'], [0.55, '#99C483'], [1, '#2F5B1A']],
                    labels: {
                        format: '{value}'
                    }
        },

      plotOptions: {
        mapline: {
          showInLegend: false,
          enableMouseTracking: false
        }
      },

      series: [
        {
          mapData: countiesMap,
          data: data,
          joinBy: ["hc-key", "code"],
          name: "Vaccination Rate",
          tooltip: {
            valueSuffix: ""
          },
          borderWidth: 0.5,
          states: {
            hover: {
              color: "#a4edba"
            }
          },
          shadow: false
        },
        {
          type: "mapline",
          name: "State borders",
          data: borderLines,
          color: "white",
          shadow: false
        },
        {
          type: "mapline",
          name: "Separator",
          data: separatorLines,
          color: "gray",
          shadow: false
        }
      ]
    });
  }, 0);
});


